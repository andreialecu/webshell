---
id: implementing-features
title: Implementing Features
---

import { Webshell } from './Webshell';
import { Term } from './Term';
import { APIReference } from './APIReference.jsx';
import { APIBox } from './APIBox.jsx';
import { DualCodeSource, SingleCodeSource } from './CodeSource';

<APIBox reference="makeFeature" type="function" />

To have a good sense on how to make new features, we will take a look at
a simplified implementation of <APIReference reference="handleLinkPressFeature" type="variable" />.
It is best to follow typescript snippet, which is convenient to convey the
shape of objects implied in a <Term id="DOM" /> feature. There are four
important items to specify a feature:

| Requirement                                                                            | Implementation     |
| :------------------------------------------------------------------------------------- | :----------------- |
| How does it behave in the <Term id="DOM" />?                                           | `linkPressScript`  |
| What options can it be assembled with?                                                 | `LinkPressOptions` |
| What is the name of the DOM message handler prop which will be available in the shell? | `onDOMLinkPress`   |
| What type of payload does it ship with events?                                         | `LinkPressTarget`  |

<DualCodeSource sourceBase="handle-link-press" />

The behavior in the DOM is implemented in the following file:

<SingleCodeSource source="handle-link-press.webjs" lang="js" />

:::important

Please note the following:

- The extension, _webjs_ is arbitrary, see the [tooling section](./tooling);
- The implementation is naive and doesn't handle inner click events contrary to <APIReference reference="handleLinkPressFeature" type="variable" />.

:::

**Every DOM script top declaration must be a function** taking one argument.
The shape of this argument is depicted in <APIReference reference="WebjsContext" type="interface" /> definition. For wide
compatibility purposes, it is recommended to

- enforce ECMAScript 5 syntax with ESlint;
- lint the script with the
  [eslint-plugin-compat](https://www.npmjs.com/package/eslint-plugin-compat) to
  enforce backward compatibility with old engines;
- unit-test with jest jsdom environment (easily achievable with [@formidable-webview/ersatz](https://github.com/formidable-webview/ersatz));

See the [tooling section](./tooling) for more details on how to achieve this.
