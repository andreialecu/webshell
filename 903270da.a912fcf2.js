(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{107:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return b})),a.d(t,"metadata",(function(){return d})),a.d(t,"rightToc",(function(){return h})),a.d(t,"default",(function(){return p}));var n=a(2),i=a(6),c=(a(0),a(110));var r=a(114),o=a(129),l=a(130),s=a(123),b={id:"autoheight",sidebar_label:"Autoheight WebView",title:"Autoheight WebView"},d={unversionedId:"autoheight",id:"autoheight",isDocsHomePage:!1,title:"Autoheight WebView",description:"This component height automatically and dynamically adapts to the page height,",source:"@site/docs/autoheight.mdx",slug:"/autoheight",permalink:"/webshell/docs/autoheight",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/autoheight.mdx",version:"current",sidebar_label:"Autoheight WebView",sidebar:"someSidebar",previous:{title:"Getting Started",permalink:"/webshell/docs/getting-started"},next:{title:"Implementing Features",permalink:"/webshell/docs/implementing-features"}},h=[{value:"Highlights",id:"highlights",children:[]},{value:"Basic Example",id:"basic-example",children:[]},{value:"Caveats and their Workarounds",id:"caveats-and-their-workarounds",children:[{value:"Mobile Virtual Viewport",id:"mobile-virtual-viewport",children:[]},{value:"Cyclic Size Constraints \u221e",id:"cyclic-size-constraints-\u221e",children:[]}]},{value:"Robust Example",id:"robust-example",children:[]},{value:"Integration with ScrollView",id:"integration-with-scrollview",children:[{value:"Recommended ScrollView Props Values",id:"recommended-scrollview-props-values",children:[]},{value:"Handling <code>hashchange</code> Events",id:"handling-hashchange-events",children:[]}]}],m={rightToc:h};function p(e){var t=e.components,a=Object(i.a)(e,["components"]);return Object(c.b)("wrapper",Object(n.a)({},m,a,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,"This component height automatically and dynamically adapts to the page height,\nanytime the DOM changes."),Object(c.b)(l.a,{reference:"useAutoheight",type:"function",mdxType:"APIBox"}),Object(c.b)("h2",{id:"highlights"},"Highlights"),Object(c.b)("p",null,"A modular, state-of-the-art implementation which goes beyond many preexisting solutions."),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"The ",Object(c.b)("strong",{parentName:"li"},"width")," of the viewport will grow to the\navailable horizontal space and won't need to be specified. You can\noverride this behavior by setting explicit ",Object(c.b)("inlineCode",{parentName:"li"},"width")," as a\nparameter attribute of ",Object(c.b)(r.a,{reference:"useAutoheight",type:"function",mdxType:"APIReference"})," hook."),Object(c.b)("li",{parentName:"ul"},"The ",Object(c.b)("strong",{parentName:"li"},"height")," of the viewport, also called layout\nheight, will dynamically adapts to the content height, which has\nbeen constrained by the layout width as we have just mentioned! It\nmeans that anytime the content changes or the layout width changes,\nsuch as in screen rotations, the layout height will get updated."),Object(c.b)("li",{parentName:"ul"},"This hook will rely on ",Object(c.b)(r.a,{reference:"HandleHTMLDimensionsFeature",type:"variable",mdxType:"APIReference"})," to use the best API\navailable in the browser\n",Object(c.b)("strong",{parentName:"li"},"and dynamically adapt layout to content size"),". In\norder of preference,\n",Object(c.b)("a",Object(n.a)({parentName:"li"},{href:"https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver"}),"ResizeObserver"),",\n",Object(c.b)("a",Object(n.a)({parentName:"li"},{href:"https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver"}),"MutationObserver"),"\nand finally, polling on a regular interval.")),Object(c.b)("h2",{id:"basic-example"},"Basic Example"),Object(c.b)("p",null,"As previously stated, ",Object(c.b)(r.a,{reference:"useAutoheight",type:"function",mdxType:"APIReference"}),"\nrequires ",Object(c.b)("em",{parentName:"p"},"a minima")," injection of a ",Object(c.b)(r.a,{reference:"HandleHTMLDimensionsFeature",type:"variable",mdxType:"APIReference"})," in the shell to fetch content dimensions:"),Object(c.b)(s.b,{jsx:!0,titleBase:"MinimalAutoheightWebView",sourceBase:"minimal-autoheight",mdxType:"DualCodeSource"}),Object(c.b)("h2",{id:"caveats-and-their-workarounds"},"Caveats and their Workarounds"),Object(c.b)("h3",{id:"mobile-virtual-viewport"},"Mobile Virtual Viewport"),Object(c.b)("p",null,"In some circumstances, the mobile browser might use a virtual\nviewport much larger then the available width in the ",Object(c.b)(o.b,{mdxType:"WebView"}),", often\naround 980px for websites which have been built for desktop. For\nthis autoheight component to be reliable, you must ensure that the\ncontent has a ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.w3schools.com/css/css_rwd_viewport.asp"}),"meta viewport element"),"\nin the header."),Object(c.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(c.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(c.b)("h5",{parentName:"div"},Object(c.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(c.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(c.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"solution")),Object(c.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(c.b)("p",{parentName:"div"},"This can be enforced by setting responsive layout with ",Object(c.b)(r.a,{reference:"ForceResponsiveViewportFeature",type:"variable",mdxType:"APIReference"}),"."),Object(c.b)("pre",{parentName:"div"},Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js",metastring:"{4}","{4}":!0}),"const Webshell = makeWebshell(\n  WebView,\n  new HandleHTMLDimensionsFeature(),\n  new ForceResponsiveViewportFeature({ maxScale: 1 })\n);\n")))),Object(c.b)("h3",{id:"cyclic-size-constraints-\u221e"},"Cyclic Size Constraints ","\u221e"),Object(c.b)("p",null,"Because the ",Object(c.b)("strong",{parentName:"p"},"viewport height")," now depends on ",Object(c.b)("strong",{parentName:"p"},"content heigh"),", you must never have a ",Object(c.b)("strong",{parentName:"p"},"body")," element\nheight depending on viewport height, such as:"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-css",metastring:'title="evil.css"',title:'"evil.css"'}),"body {\n  height: 100vh;\n}\n")),Object(c.b)("div",{className:"margin-bottom--md",style:{textAlign:"center",fontStyle:"italic"}},"or"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-css",metastring:'title="evil.css"',title:'"evil.css"'}),"body {\n  height: 100%;\n}\n")),Object(c.b)("p",null,"That is an evil cyclic dependency ready to cast an infinite loop!"),Object(c.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(c.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(c.b)("h5",{parentName:"div"},Object(c.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(c.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(c.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"solution")),Object(c.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(c.b)("p",{parentName:"div"},"Body width and height can be forced to\n",Object(c.b)("strong",{parentName:"p"},"auto")," with ",Object(c.b)(r.a,{reference:"ForceElementSizeFeature",type:"variable",mdxType:"APIReference"}),"."),Object(c.b)("pre",{parentName:"div"},Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js",metastring:"{4,5,6,7}","{4,5,6,7}":!0}),"const Webshell = makeWebshell(\n  WebView,\n  new HandleHTMLDimensionsFeature(),\n  new ForceElementSizeFeature({\n    target: 'body',\n    heightValue: 'auto',\n    widthValue: 'auto'\n  })\n);\n")))),Object(c.b)("h2",{id:"robust-example"},"Robust Example"),Object(c.b)("p",null,"In this example, we use the two tips listed in above Caveats section to provide a much resilient implementation."),Object(c.b)(s.b,{jsx:!0,titleBase:"ResilientAutoheightWebView",sourceBase:"resilient-autoheight",mdxType:"DualCodeSource"}),Object(c.b)("h2",{id:"integration-with-scrollview"},"Integration with ScrollView"),Object(c.b)("p",null,"More often than not, an autoheight feature is needed to embed the ",Object(c.b)(o.b,{mdxType:"WebView"})," along with\ncontent of unpredictable length, and a ",Object(c.b)(o.a,{name:"ScrollView",type:"class",mdxType:"ReactReference"})," works just fine.\nThis section summarize best practices and tricks for a perfect integration."),Object(c.b)("h3",{id:"recommended-scrollview-props-values"},"Recommended ScrollView Props Values"),Object(c.b)("table",null,Object(c.b)("thead",{parentName:"table"},Object(c.b)("tr",{parentName:"thead"},Object(c.b)("th",Object(n.a)({parentName:"tr"},{align:"left"}),"Prop"),Object(c.b)("th",Object(n.a)({parentName:"tr"},{align:"left"}),"Value"),Object(c.b)("th",Object(n.a)({parentName:"tr"},{align:"left"}),"Rationale"))),Object(c.b)("tbody",{parentName:"table"},Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:"left"}),Object(c.b)("inlineCode",{parentName:"td"},"pinchGestureEnabled")),Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:"left"}),Object(c.b)("inlineCode",{parentName:"td"},"false")),Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:"left"}),"Enabling pinch (the default) will conflict with the pinch-to-zoom feature provided by ",Object(c.b)(r.a,{reference:"ForceResponsiveViewportFeature",type:"variable",mdxType:"APIReference"})," ",Object(c.b)("inlineCode",{parentName:"td"},"maxScale")," option. When ",Object(c.b)("inlineCode",{parentName:"td"},"maxScale")," is above ",Object(c.b)("inlineCode",{parentName:"td"},"1"),", it will allow for pinch to zoom gestures up to the provided zoom level.")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:"left"}),Object(c.b)("inlineCode",{parentName:"td"},"horizontal")),Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:"left"}),Object(c.b)("inlineCode",{parentName:"td"},"false")),Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:"left"}),"When the web page is ill-designed (not-responsive), the content might overflows horizontally. We suggest to avoid nesting components providing scroll in the same direction, unless necessary.")))),Object(c.b)("h3",{id:"handling-hashchange-events"},"Handling ",Object(c.b)("inlineCode",{parentName:"h3"},"hashchange")," Events"),Object(c.b)("p",null,"However, scroll to hash on link press, for example:"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-html"}),'<a href="#head">go to top</a>\n')),Object(c.b)("p",null,"will not work, because the underlying ",Object(c.b)(o.b,{mdxType:"WebView"})," will not have vertical scroll anymore."),Object(c.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(c.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(c.b)("h5",{parentName:"div"},Object(c.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(c.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(c.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"solution")),Object(c.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(c.b)("p",{parentName:"div"},"You can register a prop to listen to ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/hashchange_event"}),"haschange")," events with ",Object(c.b)(r.a,{reference:"HandleHashChangeFeature",type:"variable",mdxType:"APIReference"}),"."),Object(c.b)("pre",{parentName:"div"},Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-jsx",metastring:"{4}","{4}":!0}),"const Webshell = makeWebshell(\n  WebView,\n  new HandleHTMLDimensionsFeature(),\n  new HandleHashChangeFeature({ shouldResetHashOnEvent: true })\n);\n")))),Object(c.b)("p",null,"After that, you must implement the desired behavior, that is to scroll to the\ndesired DOM element when a hashchange event is fired, while accounting for the space\noccupied by components above the shell, inside the ",Object(c.b)(o.a,{name:"ScrollView",type:"class",mdxType:"ReactReference"}),". Below is a complete\nexample:"),Object(c.b)(s.b,{jsx:!0,sourceBase:"scrollview",titleBase:"AutoheightWebViewInScrollView",mdxType:"DualCodeSource"}))}p.isMDXComponent=!0},114:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return c}));var n=a(0),i=function(e){var t=e.reference,a=e.member,i=e.type;return n.createElement("span",{className:"api-symbol "+i},t,a?"."+a:"")},c=function(e){var t=e.reference,a=e.type,i=e.overrideUrl,c=e.member,r=c?"#"+c.toLowerCase():"",o="interface"===a?"/docs/api/interfaces/"+t.toLowerCase()+r:"class"===a?"/docs/api/classes/"+t.toLowerCase()+r:"enum"===a?"/docs/api/enums/"+t.toLowerCase()+r:"/docs/api/index#"+t.toLowerCase();return n.createElement("a",{className:"api-ref api-symbol "+a,href:i||o},t,c?"."+c:"")}},123:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"d",(function(){return d})),a.d(t,"c",(function(){return h})),a.d(t,"b",(function(){return m}));var n=a(0),i=a(124),c=a(113),r=a(121),o=a(122);function l(e){const[t,a]=n.useState({content:"",error:!1});return n.useEffect(()=>{let t=!1;return async function(){try{const n=await fetch(e);if(n.ok){const e=await n.text();!t&&a({error:!1,content:e})}else!t&&a({error:!0,content:""})}catch(n){console.info(n),!t&&a({error:!0,content:""})}}(),()=>{t=!0}},[e]),t}const s=({children:e})=>n.createElement("div",{className:"mdxCodeBlock__-node_modules-@docusaurus-theme-classic-lib-theme-MDXComponents-"},e),b=({lang:e,lines:t,title:a,content:c})=>n.createElement(i.a,{className:"language-"+e,metastring:`${t?`{${t}}`:""} ${a?`title="${a}"`:""}`,title:a},c),d=({source:e,lang:t,lines:a,title:i})=>{const r=l(Object(c.a)("snippets/"+e)),o=i||e;return n.createElement(s,null,n.createElement(b,{lang:t,content:r.content,lines:a,title:o}))},h=({packages:e,dev:t=!1})=>n.createElement(r.a,{defaultValue:"yarn",values:[{label:"yarn",value:"yarn"},{label:"npm",value:"npm"}]},n.createElement(o.a,{value:"yarn"},n.createElement(b,{lang:"sh",content:`yarn add ${t?"--dev ":""}${e.split(/\s+/).join(" \\\n         ")}`})),n.createElement(o.a,{value:"npm"},n.createElement(b,{lang:"sh",content:`npm install --save ${t?"--only=dev ":""}${e.split(/\s+/).join(" \\\n    ")}`}))),m=({sourceBase:e,titleBase:t,jsx:a=!1,lines:i=null})=>{const d=Object(c.a)(`snippets/${e}.${a?"tsx":"ts"}`),h=Object(c.a)(`snippets/${e}.${a?"jsx":"js"}`),m=l(d),p=l(h),u=t||e;return m.error?n.createElement("div",{className:"alert alert--error"},e," snippet could not be loaded"):n.createElement(s,null,n.createElement(r.a,{defaultValue:"ts",values:[{label:"Typescript",value:"ts"},{label:"JavaScript",value:"js"}]},n.createElement(o.a,{value:"ts"},n.createElement(b,{lang:a?"tsx":"ts",content:m.content,lines:i,title:`${u}.${a?"tsx":"ts"}`})),n.createElement(o.a,{value:"js"},n.createElement(b,{lang:a?"jsx":"js",content:p.content,lines:i,title:`${u}.${a?"jsx":"js"}`}))))}},129:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return r}));var n=a(0);const i={webview:"https://github.com/react-native-community/react-native-webview",scrollview:"https://reactnative.dev/docs/scrollview",linking:"https://reactnative.dev/docs/linking",__dev__:"https://reactnative.dev/docs/javascript-environment.html"},c=({name:e,type:t})=>{const a=i[e&&e.toLowerCase()],c=a?e:"MISSING REFERENCE FOR "+e;return n.createElement("a",{className:"api-ref api-symbol "+t,href:a},c)},r=()=>n.createElement(c,{name:"WebView",type:"class"})},130:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),i=a(114);const c=e=>n.createElement("div",{className:"card api-box shadow--lt",style:{textAlign:"center"}},n.createElement("div",{className:"card__header api-box__title"},"~ API Reference ~"),n.createElement(i.a,e))}}]);